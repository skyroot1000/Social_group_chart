function countChecked(){"all"===checkState&&$(".bulk_action input[name='table_records']").iCheck("check"),"none"===checkState&&$(".bulk_action input[name='table_records']").iCheck("uncheck");var e=$(".bulk_action input[name='table_records']:checked").length;e?($(".column-title").hide(),$(".bulk-actions").show(),$(".action-cnt").html(e+" Records Selected")):($(".column-title").show(),$(".bulk-actions").hide())}function checkSize(){console.log("window resize action"),init_socialRating(),init_follower(),init_keyword(0)}function init_aboutMe(){console.log("init about me");var e=isCustomer?getCompetitorData(0,0):getUserData(0);$("#u_companyName").text(e.bbs_company_name),$("#u_address").text(e.bbs_address),$("#u_websiteName").text(e.bbs_website),$("#u_googleRating").text(e.bbs_google_rating),$("#u_googleReview").text(e.bbs_google_review),$("#u_category").text(e.category)}function init_socialRating(){console.log("init rating"),$("#u_rating tbody tr").empty();for(var e=0;e<5;e++){var t=[];t=isCustomer?getCompetitorData(e,0):getUserData(e);var a="<tr><td>"+t.bbs_website+'</td><td><div class="rateYoStar" id="u_ratingG'+e+'"></div><div class="starValue hidden">'+t.bbs_google_rating+'</div></td><td><div class="rateYoStar" id="u_ratingF'+e+'"></div><div class="starValue hidden">'+t.facebook_rating+'</div></td><td><div class="rateYoStar" id="u_ratingY'+e+'"></div><div class="starValue hidden">'+t.yelp_rating+"</div></td></tr>";$("#u_rating tbody").append(a),$("#u_ratingG"+e).rateYo({rating:t.bbs_google_rating,readOnly:!0,starWidth:"25px",normalFill:"#a0a0a0",rateFill:"#e74c3c"}),$(".rateYoStar").rateYo({rating:t.facebook_rating,readOnly:!0,starWidth:"25px",normalFill:"#a0a0a0",rateFill:"#e74c3c"}),$(".rateYoStar").rateYo({rating:t.yelp_rating,readOnly:!0,starWidth:"25px",normalFill:"#a0a0a0",rateFill:"#e74c3c"}),window.matchMedia("(max-width: 375px)").matches?($(".rateYoStar").addClass("hidden"),$(".starValue").removeClass("hidden")):window.matchMedia("(max-width: 500px)").matches?($(".rateYoStar").rateYo("option","starWidth","12px"),$(".starValue").addClass("hidden"),$(".rateYoStar").removeClass("hidden")):($(".rateYoStar").rateYo("option","starWidth","20px"),$(".starValue").addClass("hidden"),$(".rateYoStar").removeClass("hidden"))}}function init_singleRanking(){console.log("init signle ranking");for(var e=0;e<5;e++){var t=[];t=isCustomer?getCompetitorData(e,0):getUserData(e);var a='<div class="col-sm-5ths col-xs-6 tile_stats_count"><span class="count_top"><i class="fa fa-user"></i> '+t.bbs_website+'</span><div class="count">'+t.website_global_rank+"</div>"+(t.web_global_rank_delta>=0?'<span class="count_bottom"><i class="green"><i class="fa fa-sort-asc"></i>'+t.web_global_rank_delta+"</i> From last Month</span>":'<span class="count_bottom"><i class="red"><i class="fa fa-sort-desc"></i>'+t.web_global_rank_delta+"</i> From last Week</span>")+"</div>";$("#u_singleRanking").append(a)}}function initAllChart(){console.log("Init All chart"),init_aboutMe(),init_socialRating(),init_follower(),init_singleRanking(),init_multiRanking(),init_keyword(0)}function init_multi_follower(e){if($("#line-chart").length&&isCustomer){for(var t=[],a=[],i=[],n=[],o=[],r=getCompetitorData(e,0).bbs_website,l=0;l<5;l++){var s=getCompetitorData(e,l);t[l]=l,i[l]=s.facebook_follower,n[l]=s.tw_follower,o[l]=s.in_follower}a=[{data:i,label:"facebook",borderColor:"#f1a90d",fill:!1},{data:n,label:"twitter",borderColor:"#064dca",fill:!1},{data:o,label:"linkedIn",borderColor:"#1abb9c",fill:!1}],new Chart(document.getElementById("line-chart"),{type:"line",data:{labels:t,datasets:a},options:{title:{display:!0,text:r+" followers data"}}})}else $("#multi_follower").hide()}function init_follower(){if("undefined"!=typeof echarts){var e={color:["#f1a90d","#064dca","#1abb9c","#9b59b6","#34495e","#8abb6f","#759c6a","#bfd3b7"],title:{itemGap:8,textStyle:{fontWeight:"normal",color:"#408829"}},dataRange:{color:["#1f610a","#97b58d"]},toolbox:{color:["#408829","#408829","#408829","#408829"]},tooltip:{backgroundColor:"rgba(0,0,0,0.5)",axisPointer:{type:"line",lineStyle:{color:"#408829",type:"dashed"},crossStyle:{color:"#408829"},shadowStyle:{color:"rgba(200,200,200,0.3)"}}},textStyle:{fontFamily:"Arial, Verdana, sans-serif"}};if($("#follower_chart").length){for(var t=echarts.init(document.getElementById("follower_chart"),e),a=[],i=[],n=[],o=[],r=0;r<5;r++){var l=[];l=isCustomer?getCompetitorData(r,4):getUserData(r),a[r]=l.bbs_website,i[r]=l.facebook_follower,n[r]=l.tw_follower,o[r]=l.in_follower}t.setOption({tooltip:{trigger:"axis"},legend:{data:["Facebook","Twitter","LinkedIn"]},toolbox:{show:!1},calculable:!1,xAxis:[{type:"category",data:a,axisLabel:{interval:0,rotate:35}}],yAxis:[{type:"value"}],series:[{name:"Facebook",type:"bar",data:i,markPoint:{data:[{name:"followers",value:i[0],xAxis:0,yAxis:i[0]}]},markLine:{data:[{type:"average",name:"???"}]}},{name:"Twitter",type:"bar",data:n,markPoint:{data:[{name:"followers",value:n[0],xAxis:0,yAxis:n[0]}]},markLine:{data:[{type:"average",name:"???"}]}},{name:"LinkedIn",type:"bar",data:o,markPoint:{data:[{name:"follower",value:o[0],xAxis:0,yAxis:o[0]}]},markLine:{data:[{type:"average",name:"???"}]}}]})}init_multi_follower(u_current_followd)}}function init_keyword(e){var t=[];t=isCustomer?getCompetitorData(e,4):getUserData(e);for(var a=[],i=[],n=0,o=[],r=0;r<t.key_entity.length;r++){a[r]=t.key_entity[r].key_entity_key;var i=t.key_entity[r].key_entity_search_volume_monthly[0];n+=i,o.push({value:i,name:a[r]});var l={color:["#26B99A","#34495E","#BDC3C7","#3498DB","#9B59B6","#8abb6f","#759c6a","#bfd3b7"]};if($("#echart_donut").length){var s=echarts.init(document.getElementById("echart_donut"),l);s.setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},calculable:!0,toolbox:{show:!0,feature:{magicType:{show:!0,type:["pie","funnel"],option:{funnel:{x:"25%",width:"50%",funnelAlign:"center",max:n}}}}},series:[{name:"Used keywords",type:"pie",radius:["35%","55%"],itemStyle:{normal:{label:{show:!0},labelLine:{show:!0}},emphasis:{label:{show:!0,position:"center",textStyle:{fontSize:"14",fontWeight:"normal"}}}},data:o}]})}}}function init_multiRanking(){function e(e){"undefined"==typeof e.dataSeries.visible||e.dataSeries.visible?e.dataSeries.visible=!1:e.dataSeries.visible=!0,s.render()}if($("#ranks_chart").length&&isCustomer){for(var t=["#f1a90d","#064dca","#1abb9c","#9b59b6","#34495e"],a=[],i=0;i<5;i++){var n=[],o=getCompetitorData(i,0).website_global_rank;n[0]={label:"Initial",y:o};for(var r=1;r<5;r++){var l=getCompetitorData(i,r).website_global_rank;n[r]={label:r,y:l-o},o=l}n[5]={label:"Final",isCumulativeSum:!0,indexLabel:"{y}"},a[i]={type:"waterfall",name:getCompetitorData(i,0).bbs_website,showInLegend:!0,indexLabelOrientation:"vertical",indexLabelFontColor:"black",color:t[i],dataPoints:n}}var s=new CanvasJS.Chart("ranks_chart",{theme:"light1",animationEnabled:!0,axisX:{interval:1},axisY:{valueFormatString:"#,##0,.K"},toolTip:{shared:!0},legend:{cursor:"pointer",itemclick:e},data:a});s.render()}else $("#multi_ranking").hide()}!function(e,t){var a=function(e,t,a){var i;return function(){function n(){a||e.apply(o,r),i=null}var o=this,r=arguments;i?clearTimeout(i):a&&e.apply(o,r),i=setTimeout(n,t||100)}};jQuery.fn[t]=function(e){return e?this.bind("resize",a(e)):this.trigger(t)}}(jQuery,"smartresize");var CURRENT_URL=window.location.href.split("#")[0].split("?")[0],$BODY=$("body"),$MENU_TOGGLE=$("#menu_toggle"),$SIDEBAR_MENU=$("#sidebar-menu"),$SIDEBAR_FOOTER=$(".sidebar-footer"),$LEFT_COL=$(".left_col"),$RIGHT_COL=$(".right_col"),$NAV_MENU=$(".nav_menu"),$FOOTER=$("footer");$(document).ready(function(){var e=function(){$RIGHT_COL.css("min-height",$(window).height());var e=$BODY.outerHeight(),t=$BODY.hasClass("footer_fixed")?-10:$FOOTER.height(),a=$LEFT_COL.eq(1).height()+$SIDEBAR_FOOTER.height(),i=e<a?a:e;i-=$NAV_MENU.height()+t,$RIGHT_COL.css("min-height",i)};$SIDEBAR_MENU.find("a").on("click",function(t){var a=$(this).parent();a.is(".active")?(a.removeClass("active active-sm"),$("ul:first",a).slideUp(function(){e()})):(a.parent().is(".child_menu")||($SIDEBAR_MENU.find("li").removeClass("active active-sm"),$SIDEBAR_MENU.find("li ul").slideUp()),a.addClass("active"),$("ul:first",a).slideDown(function(){e()}))}),$MENU_TOGGLE.on("click",function(){$BODY.hasClass("nav-md")?($SIDEBAR_MENU.find("li.active ul").hide(),$SIDEBAR_MENU.find("li.active").addClass("active-sm").removeClass("active")):($SIDEBAR_MENU.find("li.active-sm ul").show(),$SIDEBAR_MENU.find("li.active-sm").addClass("active").removeClass("active-sm")),$BODY.toggleClass("nav-md nav-sm"),e(),$(".dataTable").each(function(){$(this).dataTable().fnDraw()})}),$SIDEBAR_MENU.find('a[href="'+CURRENT_URL+'"]').parent("li").addClass("current-page"),$SIDEBAR_MENU.find("a").filter(function(){return this.href==CURRENT_URL}).parent("li").addClass("current-page").parents("ul").slideDown(function(){e()}).parent().addClass("active"),$(window).smartresize(function(){e()}),e(),$.fn.mCustomScrollbar&&$(".menu_fixed").mCustomScrollbar({autoHideScrollbar:!0,theme:"minimal",mouseWheel:{preventDefault:!0}})}),$(document).ready(function(){$(".collapse-link").on("click",function(){var e=$(this).closest(".x_panel"),t=$(this).find("i"),a=e.find(".x_content");e.attr("style")?a.slideToggle(200,function(){e.removeAttr("style")}):(a.slideToggle(200),e.css("height","auto")),t.toggleClass("fa-chevron-up fa-chevron-down")}),$(".close-link").click(function(){var e=$(this).closest(".x_panel");e.remove()})}),$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip({container:"body"})}),$(document).ready(function(){$(".progress .progress-bar")[0]&&$(".progress .progress-bar").progressbar()}),$(document).ready(function(){if($(".js-switch")[0]){var e=Array.prototype.slice.call(document.querySelectorAll(".js-switch"));e.forEach(function(e){new Switchery(e,{color:"#26B99A"})})}}),$(document).ready(function(){$("input.flat")[0]&&$(document).ready(function(){$("input.flat").iCheck({checkboxClass:"icheckbox_flat-green",radioClass:"iradio_flat-green"})})}),$("table input").on("ifChecked",function(){checkState="",$(this).parent().parent().parent().addClass("selected"),countChecked()}),$("table input").on("ifUnchecked",function(){checkState="",$(this).parent().parent().parent().removeClass("selected"),countChecked()});var checkState="";$(".bulk_action input").on("ifChecked",function(){checkState="",$(this).parent().parent().parent().addClass("selected"),countChecked()}),$(".bulk_action input").on("ifUnchecked",function(){checkState="",$(this).parent().parent().parent().removeClass("selected"),countChecked()}),$(".bulk_action input#check-all").on("ifChecked",function(){checkState="all",countChecked()}),$(".bulk_action input#check-all").on("ifUnchecked",function(){checkState="none",countChecked()}),$(document).ready(function(){$(".expand").on("click",function(){$(this).next().slideToggle(200),$expand=$(this).find(">:first-child"),"+"==$expand.text()?$expand.text("-"):$expand.text("+")})}),"undefined"!=typeof NProgress&&($(document).ready(function(){NProgress.start()}),$(window).on("load",function(){NProgress.done()})),$(document).ready(function(){$(window).resize(checkSize);var e=setInterval(function(){if(!timerFlag){t();var e=document.getElementById("u_body");e.style.display="block",initAllChart()}},10),t=function(){clearInterval(e)}});var u_current_followd=0;$(document).ready(function(){$("#u_before_follower").click(function(){0!=u_current_followd&&(u_current_followd--,init_multi_follower(u_current_followd))}),$("#u_next_follower").click(function(){console.log("next button"),u_current_followd!=social_total_multi_data[0].length-1&&(u_current_followd++,init_multi_follower(u_current_followd))})});var u_current_keyword=0;$(document).ready(function(){$("#u_before_keyword").click(function(){0!=u_current_keyword&&(u_current_keyword--,init_keyword(u_current_keyword))}),$("#u_next_keyword").click(function(){var e=isCustomer?social_total_multi_data[0].length:social_total_data.length;u_current_keyword!=e-1&&(u_current_keyword++,init_keyword(u_current_keyword))})});